import{f as p,q as $,g as A,r as L,o as l,c as n,b as t,a as b,w as U,e as P,A as N,y as j,z as B,x as F,F as y,i as C,p as D,l as i,v as d,B as T,t as x}from"./index-CRSfcWBD.js";import{S as k}from"./sweetalert2.all-CUpMDFVy.js";import{g as q,i as z,j as E,k as O,u as Q,l as R}from"./api-wHJjAYCR.js";import{_ as G,F as H}from"./FooterComponent-Bjy2HOxr.js";import{u as J,_ as K}from"./Pagination-BuGYM5K0.js";const V=v=>(j("data-v-a98cb214"),v=v(),B(),v),W={class:"navbar navbar-expand-lg navbar-dark position-absolute top-0 start-50 translate-middle-x container",style:{width:"100%"}},X={class:"container-fluid mx-5 navbar-brand"},Y=V(()=>t("h2",null,"後台管理頁面",-1)),Z=V(()=>t("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation"},[t("span",{class:"navbar-toggler-icon"})],-1)),tt={class:"collapse navbar-collapse justify-content-lg-end",id:"navbarSupportedContent",style:{"margin-right":"auto"}},et={class:"navbar-nav mb-2 mb-lg-0"},st={class:"nav-item"},ot={class:"nav-item"},at={__name:"AdminNavComponent",setup(v){const w=p([]),f=p(0),g=p(!1),r=$();A(async()=>{await e()});async function e(){g.value=!0;try{const h=await q();w.value=h.data.data.carts,f.value=w.value.reduce((_,u)=>_+u.qty,0)}catch{}}function c(){N.defaults.headers.common.Authorization="",r.push("/login")}return(h,_)=>{const u=L("router-link");return l(),n("nav",W,[t("div",X,[b(u,{to:"/",class:"navbar-brand fs-1 fw-bold demo text-white",id:"fp"},{default:U(()=>[P("動起來~ ")]),_:1}),Y,Z,t("div",tt,[t("ul",et,[t("li",st,[b(u,{to:"/",class:"nav-link text-color-1","aria-current":"page"},{default:U(()=>[P("首頁")]),_:1})]),t("li",ot,[b(u,{to:"/adminProducts",class:"nav-link"},{default:U(()=>[P("課程管理")]),_:1})]),t("li",null,[t("button",{type:"button",class:"btn btn-outline-primary",onClick:c},"登出")])])])])])}}},lt=G(at,[["__scopeId","data-v-a98cb214"]]),nt={class:"mt-5 pt-5 about"},it={class:"container main-content pt-5 px-5"},rt={class:"text-end"},dt={class:"table mt-4 text-center"},ct=t("thead",null,[t("tr",null,[t("th",{width:"120"}," 分類 "),t("th",null,"課程名稱"),t("th",{width:"120"}," 原價 "),t("th",{width:"120"}," 售價 "),t("th",{width:"100"}," 是否啟用 "),t("th",{width:"120"})])],-1),ut={key:0,class:"text-success fw-bolder"},pt={key:1},_t={class:"btn-group"},mt=["onClick"],bt=["onClick"],vt={class:"modal fade",id:"productModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},gt={class:"modal-dialog modal-xl"},ht={class:"modal-content"},ft={class:"modal-header bg-dark text-white"},yt={class:"modal-title",id:"exampleModalLabel"},xt={key:0},kt={key:1},wt=t("button",{type:"button",class:"btn-close btn-close-white","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),Ut={class:"modal-body mx-3"},Pt={class:"row"},Ct={class:"col-sm-4"},$t={class:"mb-3"},At=t("label",{for:"imageUrl",class:"form-label"},"主要圖片",-1),Vt=["src"],It=t("h3",{class:"mb-3"},"多圖新增",-1),Mt={key:0},St=["onUpdate:modelValue"],Lt=["src"],Nt={key:0},jt={key:1},Bt={key:1},Ft={class:"col-sm-8"},Dt={class:"form-group"},Tt=t("label",{for:"title"},"標題",-1),qt={class:"row"},zt={class:"form-group col-md-6"},Et=t("label",{for:"category"},"分類",-1),Ot={class:"form-group col-md-6"},Qt=t("label",{for:"price"},"單位",-1),Rt={class:"row"},Gt={class:"form-group col-md-6"},Ht=t("label",{for:"origin_price"},"原價",-1),Jt={class:"form-group col-md-6"},Kt=t("label",{for:"price"},"售價",-1),Wt=t("hr",null,null,-1),Xt={class:"form-group"},Yt=t("label",{for:"description"},"課程描述",-1),Zt={class:"form-group"},te=t("label",{for:"content"},"說明內容",-1),ee={class:"mb-3"},se={class:"form-check"},oe=t("label",{class:"form-check-label",for:"is_enabled"},"是否啟用",-1),ae={class:"modal-footer d-flex justify-content-center mx-3"},le=t("button",{type:"button",class:"btn btn-outline-secondary btn-lg","data-bs-dismiss":"modal"},"取消",-1),ue={__name:"Products",setup(v,{emit:w}){p({loadingproduct:""}),p(!1);const f=$(),g=p([]),r=J(),e=p({imageUrl:[]});A(async()=>{await M(),await c()});async function c(){try{const a=await z();g.value=Object.values(a.data.products);const s=Math.ceil(g.value.length/r.itemsPerPage);r.totalPages=s,r.setCurrentPage(1)}catch(a){console.log(a)}}const h=F(()=>{const a=(r.currentPage-1)*r.itemsPerPage,s=a+r.itemsPerPage;return g.value.slice(a,s)});async function _(a,s){a==="new"?e.value={imageUrl:[]}:a==="edit"?(this.isLoading=!0,e.value={...s}):a==="delete"&&(this.isLoading=!0,await O(s.id),await c())}async function u(a){this.isLoading=!0;try{a.id?(await Q(a)).data.success?k.fire({title:"成功!",text:"課程編輯成功",icon:"success"}).then(async o=>{o.isConfirmed&&await c()}):k.fire({title:"失敗!",text:"課程編輯失敗",icon:"error"}):(await R(a)).data.success?k.fire({title:"成功!",text:"課程新增成功",icon:"success"}).then(async o=>{o.isConfirmed&&await c()}):k.fire({title:"失敗!",text:"課程新增失敗",icon:"error"})}catch(s){console.log(s)}}function I(){e.value.imagesUrl=[],e.value.imagesUrl.push("")}async function M(){try{(await E()).data.success||f.push("/login")}catch{f.push("/login")}}return(a,s)=>(l(),n(y,null,[b(lt),t("div",nt,[t("div",it,[t("div",rt,[t("button",{type:"button",class:"btn btn-success",onClick:s[0]||(s[0]=o=>_("new")),"data-bs-toggle":"modal","data-bs-target":"#productModal"}," 建立新的課程 ")]),t("table",dt,[ct,t("tbody",null,[(l(!0),n(y,null,C(h.value,o=>(l(),n("tr",{key:o.id},[t("td",null,x(o.category),1),t("td",null,x(o.title),1),t("td",null,x(o.origin_price),1),t("td",null,x(o.price),1),t("td",null,[o.is_enabled?(l(),n("span",ut,"啟用")):(l(),n("span",pt,"未啟用"))]),t("td",null,[t("div",_t,[t("button",{type:"button",class:"btn btn-outline-primary btn-sm","data-bs-toggle":"modal","data-bs-target":"#productModal",onClick:m=>_("edit",o)}," 編輯 ",8,mt),t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:m=>_("delete",o)}," 刪除 ",8,bt)])])]))),128))])]),b(K,{pages:D(r),"get-products":c},null,8,["pages"])]),t("div",vt,[t("div",gt,[t("div",ht,[t("div",ft,[t("h5",yt,[e.value.id?(l(),n("span",xt,"編輯課程 :")):(l(),n("span",kt,"新增課程"))]),wt]),t("div",Ut,[t("div",Pt,[t("div",Ct,[t("div",$t,[At,i(t("input",{"onUpdate:modelValue":s[1]||(s[1]=o=>e.value.imageUrl=o),type:"text",class:"form-control mb-2",placeholder:"請輸入圖片連結"},null,512),[[d,e.value.imageUrl]]),t("img",{class:"img-fluid",src:e.value.imageUrl},null,8,Vt)]),It,Array.isArray(e.value.imagesUrl)?(l(),n("div",Mt,[(l(!0),n(y,null,C(e.value.imagesUrl,(o,m)=>(l(),n(y,{key:m},[i(t("input",{"onUpdate:modelValue":S=>e.value.imagesUrl[m]=S,type:"text",class:"form-control"},null,8,St),[[d,e.value.imagesUrl[m]]]),t("img",{src:e.value.imagesUrl[m],alt:"",class:"img-fluid mb-2 mt-2"},null,8,Lt)],64))),128)),!e.value.imagesUrl.length||e.value.imagesUrl[e.value.imagesUrl.length-1]?(l(),n("div",Nt,[t("button",{class:"btn btn-outline-primary btn-sm d-block w-100",onClick:s[2]||(s[2]=o=>e.value.imagesUrl.push(""))}," 新增圖片 ")])):(l(),n("div",jt,[t("button",{class:"btn btn-outline-danger btn-sm d-block w-100",onClick:s[3]||(s[3]=o=>e.value.imagesUrl.pop())}," 刪除圖片 ")]))])):(l(),n("div",Bt,[t("button",{class:"btn btn-outline-primary btn-sm d-block w-100",onClick:I}," 新增圖片 ")]))]),t("div",Ft,[t("div",Dt,[Tt,i(t("input",{id:"title","onUpdate:modelValue":s[4]||(s[4]=o=>e.value.title=o),type:"text",class:"form-control",placeholder:"請輸入標題"},null,512),[[d,e.value.title]])]),t("div",qt,[t("div",zt,[Et,i(t("input",{id:"category","onUpdate:modelValue":s[5]||(s[5]=o=>e.value.category=o),type:"text",class:"form-control",placeholder:"請輸入分類"},null,512),[[d,e.value.category]])]),t("div",Ot,[Qt,i(t("input",{id:"unit","onUpdate:modelValue":s[6]||(s[6]=o=>e.value.unit=o),type:"unit",class:"form-control",placeholder:"請輸入單位"},null,512),[[d,e.value.unit]])])]),t("div",Rt,[t("div",Gt,[Ht,i(t("input",{id:"origin_price","onUpdate:modelValue":s[7]||(s[7]=o=>e.value.origin_price=o),type:"number",class:"form-control",placeholder:"請輸入原價"},null,512),[[d,e.value.origin_price]])]),t("div",Jt,[Kt,i(t("input",{id:"price","onUpdate:modelValue":s[8]||(s[8]=o=>e.value.price=o),type:"number",class:"form-control",placeholder:"請輸入售價"},null,512),[[d,e.value.price]])])]),Wt,t("div",Xt,[Yt,i(t("textarea",{id:"description","onUpdate:modelValue":s[9]||(s[9]=o=>e.value.description=o),type:"text",class:"form-control",placeholder:"請輸入課程描述"},`\r
        `,512),[[d,e.value.description]])]),t("div",Zt,[te,i(t("textarea",{id:"description","onUpdate:modelValue":s[10]||(s[10]=o=>e.value.content=o),type:"text",class:"form-control",placeholder:"請輸入說明內容"},`\r
        `,512),[[d,e.value.content]])]),t("div",ee,[t("div",se,[i(t("input",{id:"is_enabled","onUpdate:modelValue":s[11]||(s[11]=o=>e.value.is_enabled=o),class:"form-check-input",type:"checkbox","true-value":1,"false-value":0},null,512),[[T,e.value.is_enabled]]),oe])])])])]),t("div",ae,[t("button",{type:"button",class:"btn btn-success btn-lg",onClick:s[12]||(s[12]=o=>u(e.value)),"data-bs-dismiss":"modal"},"確認"),le])])])])]),b(H)],64))}};export{ue as default};
