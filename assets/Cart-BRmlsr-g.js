import{S as w}from"./sweetalert2.all-CUpMDFVy.js";import{g as C,d as q,e as I}from"./api-wHJjAYCR.js";import{N}from"./NavComponent-DgH0bBaw.js";import{F as $}from"./FooterComponent-Bjy2HOxr.js";import{f as c,g as S,h as B,c as n,a as m,b as t,F as y,i as F,t as d,j as P,w as V,d as A,r as D,o as l,e as E}from"./index-CRSfcWBD.js";const L={class:"mt-5 pt-5 about"},T={class:"pt-5 px-5 container"},j=A('<div class="row mb-2"><div class="col-md-8 col-sm-5"><div class="step-bar"><ul class="step-bar_list"><li class="step-bar_item step-bar_item--first"><div class="step-bar_circle step-bar_circle--active"><span>1</span></div><div class="step-bar_line"></div><div class="step-bar_title"><span class="mx-2 text-light">購物車</span></div></li><li class="step-bar_item step-bar_item--secondary"><div class="step-bar_circle"><span>2</span></div><div class="step-bar_line"></div><div class="step-bar_title"><span class="text-light">結帳</span></div></li><li class="step-bar_item step-bar_item--last"><div class="step-bar_circle"><span>3</span></div><div class="step-bar_line"></div><div class="step-bar_title"><span class="text-light">購買完成</span></div></li></ul></div></div></div>',1),z={class:"row"},M={class:"col-md-8 col-sm-5"},O={class:"border-white"},U={class:"table align-middle"},G=t("thead",null,[t("tr",null,[t("th"),t("th",null,"商品"),t("th",{style:{width:"110px"}},"數量"),t("th",null,"單價")])],-1),H={style:{width:"5%"}},J=["onClick","disabled"],K=t("i",{class:"bi bi-trash-fill"},null,-1),Q=[K],R={style:{width:"5%"}},W={class:"rounded-0",style:{"background-size":"cover","background-position":"center"}},X=["src"],Y={class:"d-flex flex-column align-items-stretch"},Z={class:"fs-1 mb-4"},tt={class:"input-group input-group-sm"},st=["disabled","onClick"],et=["value","id"],at=["onClick"],lt={key:1,colspan:"4",class:"text-center text-light fs-2"},ot={class:"col-md-4 mt-2"},it={class:"checkout_summary"},ct=t("div",{class:"checkout_summary-title heading-tertiary--dark"}," 訂單明細 ",-1),nt={class:"checkout_summary-price"},rt=t("div",null,"原價",-1),dt={class:"checkout_summary-total"},_t=t("div",null,"總計",-1),ut=t("div",{class:"form_row"},null,-1),pt={key:1,class:"btn btn-primary--cancel"},ft={__name:"Cart",setup(vt,{emit:g}){const p=c({loadingItem:""}),r=c(!1),f=g,a=c(0),o=c([]);c({user:{name:"",email:"",tel:"",address:""},message:""}),S(async()=>{await _()});async function _(){r.value=!0;try{const e=await C();o.value=e.data.data.carts,r.value=!1,x()}catch(e){console.log(e)}}async function k(e){r.value=!0;try{const i=await q(e);_()}catch(i){console.log(i)}p.value.loadingItem="",r.value=!1}async function v(e,i,u){try{const h=await I(e,{product_id:i,qty:u});_()}catch(s){console.log(s),w.fire({title:"失敗!",text:"請聯繫客服",allowOutsideClick:!1,icon:"error"})}}function x(){a.value=0,o.value.forEach(e=>{a.value+=e.final_total})}return B(a,()=>{f("someEvent",a.value)}),(e,i)=>{const u=D("router-link");return l(),n(y,null,[m(N),t("div",L,[t("div",T,[j,t("div",z,[t("div",M,[t("div",O,[t("table",U,[G,t("tbody",null,[o.value.length>0?(l(!0),n(y,{key:0},F(o.value,(s,h)=>(l(),n("tr",{key:s.id},[t("td",H,[t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:b=>k(s.id),disabled:p.value.loadingItem===s.id},Q,8,J)]),t("td",R,[t("div",W,[t("img",{src:s.product.imageUrl,class:"cart_img"},null,8,X)])]),t("td",null,[t("div",Y,[t("div",Z,d(s.product.title),1),t("div",tt,[t("button",{class:"border border-gray-500 px-2 py-1 bg-gray-500",disabled:s.qty===1,onClick:b=>{s.qty--,v(s.id,s.product.id,s.qty)}}," - ",8,st),t("input",{type:"number",class:"quantity border border-gray-500 text-center w-4 py-1 price",min:"1",value:s.qty,id:"quantityInput_"+h},null,8,et),t("button",{class:"border border-gray-500 px-2 py-1 bg-gray-500",onClick:b=>{s.qty++,v(s.id,s.product.id,s.qty)}}," + ",8,at)])])]),t("td",null," $"+d(s.product.price),1)]))),128)):(l(),n("td",lt,"購物車無商品，快來去逛逛!"))])])])]),t("div",ot,[t("div",it,[ct,t("div",nt,[rt,t("div",null,"$"+d(a.value),1)]),t("div",dt,[_t,t("h3",null,"$"+d(a.value),1)]),ut,o.value.length>0?(l(),P(u,{key:0,to:"/checkout",class:"btn btn-primary",style:{margin:"0px"}},{default:V(()=>[E("結帳")]),_:1})):(l(),n("button",pt," 請選擇 "))])])])])]),m($)],64)}}};export{ft as default};
